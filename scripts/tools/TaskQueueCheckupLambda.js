'use strict';

var https = require('https');
var util = require('util');
var warningColor = '#f39700';
var errorColor = '#F30000';
var queueIds = process.env.TASK_QUEUE_IDENTIFIERS.split(',');
/** The threshold value in seconds for the tasks in running state. When it is exceeded, a notification will be sent. */
var runningThreshold = parseInt(process.env.RUNNING_THRESHOLD, 10);
/** The threshold value in seconds for the tasks in enqueued state. When it is exceeded, a notification will be sent. */
var enqueuedThreshold = parseInt(process.env.ENQUEUED_THRESHOLD, 10);
/** The threshold value in seconds for the tasks in dequeued state. When it is exceeded, a notification will be sent. */
var dequeuedThreshold = parseInt(process.env.DEQUEUED_THRESHOLD, 10);
/** The threshold value in seconds since last heartbeat task creation. */
var lastHeartbeatThreshold = parseInt(process.env.LAST_HEARTBEAT_THRESHOLD, 10);

exports.handler = (event, context, callback) =>
{
    var taskLog = getTaskLog();
    var attachments = [];
    var lastTasks = {};
    var nowTimestamp = (new Date()).getTime() / 1000;
    var elapsed;

    for (var i = 0; i < taskLog.data.length; i++) {
        var taskData = taskLog.data[i];
        var queueId = taskData.taskLabel.replace('_heartbeat', '');
        elapsed = nowTimestamp - taskData.updatedAt;

        if (!(queueId in lastTasks) || lastTasks[queueId].updatedAt < taskData.updatedAt) {
            lastTasks[queueId] = taskData;
        }

        if (taskData.status === 'completed' || taskData.status === 'archived') {
            continue;
        }

        if (taskData.status === 'failed') {
            attachments.push({
                'fields': [
                    {
                        'title': 'Task ID',
                        'value': taskData.id
                    }, {
                        'title': 'Created at',
                        'value': (new Date(taskData.createdAt*1000)).toISOString()
                    }, {
                        'title': 'Updated at',
                        'value': (new Date(taskData.updatedAt*1000)).toISOString()
                    }
                ],
                'pretext'  : 'Execution of task in `' + queueId + '` queue has ben failed',
                'title'    : "Task details: \n\n",
                'color'    : errorColor
            });
        }

        if (
            (taskData.status === 'running' && elapsed > runningThreshold) ||
            (taskData.status === 'enqueued' && elapsed > enqueuedThreshold) ||
            (taskData.status === 'dequeued' && elapsed > dequeuedThreshold)
        ) {
            attachments.push({
                'fields': [
                    {
                        'title': 'Task ID',
                        'value': taskData.id
                    }, {
                        'title': 'Created at',
                        'value': (new Date(taskData.createdAt*1000)).toISOString()
                    }, {
                        'title': 'Updated at',
                        'value': (new Date(taskData.updatedAt*1000)).toISOString()
                    }
                ],
                'pretext'  : 'The task in the `' + queueId + '` queue has stuck in ' + taskData.status + ' state for a ' + elapsed + ' seconds',
                'title'    : "Task details: \n\n",
                'color'    : warningColor
            });
        }

    }

    for (var key in queueIds) {
        queueId = queueIds[key];
        if (!(queueId in lastTasks) || (nowTimestamp - lastTasks[queueId].createdAt) > lastHeartbeatThreshold) {
            attachments.push({
                'fields': [
                    {
                        'title': 'Time',
                        'value': (new Date()).toISOString()
                    }
                ],
                'pretext'  : 'Heartbeat task is missed in the `' + queueId + '` task queue',
                'title'    : "Details: \n\n",
                'color'    : errorColor
            });
        }
    }

    if (attachments.length > 0) {
        //console.log(attachments);
        sendToSlack(context, attachments);
    }
};

function getTaskLog() {
    var tmpPayload = '{"success":true,"data":[{"id":"http:\\/\\/sample\\/first.rdf#i153484244989081087","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"enqueued","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534842448,"createdAtElapsed":168911,"updatedAt":1534842448,"updatedAtElapsed":168911,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153484244989081087"},{"id":"http:\\/\\/sample\\/first.rdf#i153484244972221088","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"dequeued","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534842448,"createdAtElapsed":168911,"updatedAt":1534842448,"updatedAtElapsed":168911,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153484244972221088"},{"id":"http:\\/\\/sample\\/first.rdf#i153484244988531089","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534842448,"createdAtElapsed":168911,"updatedAt":1534842448,"updatedAtElapsed":168911,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153484244988531089"},{"id":"http:\\/\\/sample\\/first.rdf#i153484250985081090","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534842508,"createdAtElapsed":168851,"updatedAt":1534842508,"updatedAtElapsed":168851,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153484250985081090"},{"id":"http:\\/\\/sample\\/first.rdf#i153484250959041091","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534842508,"createdAtElapsed":168851,"updatedAt":1534842508,"updatedAtElapsed":168851,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153484250959041091"},{"id":"http:\\/\\/sample\\/first.rdf#i153484250979411092","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"running","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534842508,"createdAtElapsed":168851,"updatedAt":1534842508,"updatedAtElapsed":168851,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153484250979411092"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287878581333","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287878581333"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287885961334","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287885961334"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287864151335","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287864151335"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287894181336","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287894181336"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287888921337","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287888921337"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628785181338","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628785181338"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287818521339","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287818521339"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287874331340","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287874331340"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287831661341","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287831661341"},{"id":"http:\\/\\/sample\\/first.rdf#i153486258192941118","taskName":"oat\\\\taoAct\\\\model\\\\webservices\\\\tasks\\\\SendOdsPayload","status":"failed","masterStatus":false,"statusLabel":"Failed","taskLabel":"Send ODS payload","createdAt":1534862581,"createdAtElapsed":148778,"updatedAt":1534862581,"updatedAtElapsed":148778,"category":"unknown","hasFile":false},{"id":"http:\\/\\/sample\\/first.rdf#i153486287829871342","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287829871342"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287884401353","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287884401353"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287811751354","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287811751354"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287870811345","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287870811345"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628785051346","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628785051346"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287893641347","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287893641347"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628781341348","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628781341348"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287882971349","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287882971349"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287893921350","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287893921350"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287842461351","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287842461351"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287836621352","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862878,"createdAtElapsed":148481,"updatedAt":1534862878,"updatedAtElapsed":148481,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287836621352"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287619091119","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287619091119"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287664021120","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287664021120"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287616241121","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287616241121"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287625201124","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287625201124"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287690341125","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287690341125"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287695751126","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287695751126"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287699141127","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287699141127"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287628041128","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287628041128"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287662291129","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287662291129"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287651861130","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287651861130"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287639261131","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287639261131"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287642481132","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287642481132"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628768381133","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628768381133"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287636191134","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287636191134"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287643341135","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287643341135"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287648721136","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287648721136"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287617551137","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287617551137"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287667731138","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287667731138"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287681301141","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287681301141"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287653811142","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287653811142"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287643591143","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287643591143"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287698811144","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287698811144"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287645211145","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287645211145"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287640421146","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287640421146"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287668711147","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287668711147"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628766361148","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628766361148"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287621351149","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287621351149"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287611041150","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287611041150"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628766461151","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628766461151"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287695501152","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287695501152"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287690841153","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287690841153"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287763601154","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287763601154"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628776091155","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628776091155"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628779541157","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628779541157"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287782801158","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287782801158"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628779391159","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628779391159"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287731161161","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287731161161"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287778651162","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287778651162"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628774131163","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628774131163"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287744741164","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287744741164"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287715971165","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287715971165"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287748411166","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287748411166"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287722591167","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287722591167"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287759691168","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287759691168"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287799531169","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287799531169"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287728101170","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287728101170"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287764631171","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287764631171"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287739351172","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287739351172"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287726731173","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287726731173"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287729681174","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287729681174"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287782081175","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287782081175"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287767821178","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287767821178"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287716631179","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287716631179"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287737741180","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287737741180"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287726911181","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287726911181"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287750261182","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287750261182"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287770281183","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287770281183"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287797801184","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287797801184"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287724851185","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287724851185"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287770551186","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287770551186"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287717561187","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287717561187"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287722281188","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287722281188"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287764291189","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287764291189"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628779191192","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628779191192"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287738521193","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287738521193"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287749891194","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287749891194"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287745331195","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287745331195"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287763551196","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287763551196"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287731451197","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287731451197"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287729161198","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287729161198"},{"id":"http:\\/\\/sample\\/first.rdf#i15348628773721199","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"standard_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i15348628773721199"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287789281200","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"background_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287789281200"},{"id":"http:\\/\\/sample\\/first.rdf#i153486287775581201","taskName":"oat\\\\taoTaskQueue\\\\scripts\\\\tools\\\\HeartbeatTask","status":"completed","masterStatus":false,"statusLabel":"Completed","taskLabel":"priority_heartbeat","createdAt":1534862876,"createdAtElapsed":148483,"updatedAt":1534862876,"updatedAtElapsed":148483,"category":"unknown","hasFile":false,"redirectUrl":"http:\\/\\/package-tao\\/taoBackOffice\\/Redirector\\/redirectTaskToInstance?taskId=http%3A%2F%2Fsample%2Ffirst.rdf%23i153486287775581201"}],"version":"3.3.0-sprint83"}';
    //return JSON.parse(tmpPayload);
    var options = {
        method: 'GET',
        hostname: process.env.TASK_QUEUE_ENDPOINT,
        port: 443,
        path: '/tao/TaskQueueWebApi/getAll?limit=100'
    };

    var request = https.request(options, function(response) {
        console.log(arguments);
        response.setEncoding('utf8');
        response.on('data', function (data) {
            console.log(data);
        });
    });

    request.on('error', function(e) {
        console.log('Can\'t get task queue log: ' + e.message);
    });

    request.end();
}

/**
 * Send message to Slack
 */
function sendToSlack(context, attachments) {
    var postData = {
        "text": "*Task Queue notification*"
    };

    if (typeof process.env.SLACK_CHANNEL !== typeof undefined && process.env.SLACK_CHANNEL !== '') {
        postData['channel'] = process.env.SLACK_CHANNEL;
    }

    postData.attachments = attachments;

    var options = {
        method: 'POST',
        hostname: 'hooks.slack.com',
        port: 443,
        path: process.env.SLACK_SERVICE_URI
    };

    var request = https.request(options, function(response) {
        response.setEncoding('utf8');
        response.on('data', function (chunk) {
            context.done(null);
        });
    });

    request.on('error', function(e) {
        console.log('problem with slack request: ' + e.message);
    });

    request.write(util.format("%j", postData));
    request.end();
}